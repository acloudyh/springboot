
### 消息结构

| 标识位 | 消息头 | 消息体 | 校验码 | 标识位 |
| :------:| :------: | :------: | :------: | :------: |
| 1byte(0x7e) | 16byte |  | 1byte | 1byte(0x7e) |



标识位	消息头	消息体	校验码	标识位
1byte(0x7e)	16byte	 	1byte	1byte(0x7e)


### 消息头
```
消息ID(0-1)   消息体属性(2-3)  终端手机号(4-9)  消息流水号(10-11)    消息包封装项(12-15)

byte[0-1]   消息ID word(16)
byte[2-3]   消息体属性 word(16)
        bit[0-9]    消息体长度
        bit[10-12]  数据加密方式
                        此三位都为 0，表示消息体不加密
                        第 10 位为 1，表示消息体经过 RSA 算法加密
                        其它保留
        bit[13]     分包
                        1：消息体卫长消息，进行分包发送处理，具体分包信息由消息包封装项决定
                        0：则消息头中无消息包封装项字段
        bit[14-15]  保留
byte[4-9]   终端手机号或设备ID bcd[6]
        根据安装后终端自身的手机号转换
        手机号不足12 位，则在前面补 0
byte[10-11]     消息流水号 word(16)
        按发送顺序从 0 开始循环累加
byte[12-15]     消息包封装项
        byte[0-1]   消息包总数(word(16))
                        该消息分包后得总包数
        byte[2-3]   包序号(word(16))
                        从 1 开始
        如果消息体属性中相关标识位确定消息分包处理,则该项有内容
        否则无该项

```

### 示例

#### 心跳包	

 ```	
7e000200000200000000150003327e
7e # 标识位
000200000200000000150003 # 消息头
    0002 # 消息ID
    0000 # 消息体属性，消息体属性每个位都为零,也即第12-15位的消息包封装项不存在,消息体也为空
    020000000015 # 终端手机号
    0003 # 流水号
32 # 校验码
7e # 标识位
```

#### 鉴权包

```
7e010200060200000000150026313639333434397e
 7e # 标识位
010200060200000000150026 # 消息头
    0102 # 消息ID
    0006 # 消息体属性
        0x0006=0b(0000,0000,0000,0110)
        消息体长度[0-9]==0b(00,0000,0110)==6字节
        数据加密方式[10-12]==0b(000)
        分包[13]==0,也即第12-15位的消息包封装项不存在
        保留位[14-15]==00
    020000000015 # 终端手机号
    0026 # 流水号
313639333434 # 消息体 6个字节
39 # 校验码
7e # 标识位
```

#### 注册包
```
7e0100002c0200000000150025002c0133373039363054372d54383038000000000000000000000000003033323931373001d4c142383838387b7e

7e # 标识位
010200060200000000150026 # 消息头
    0100 # 消息ID
    002c # 消息体属性
        0x002c=0b(0000,0000,0010,1100)
        消息体长度[0-9]==0b(00,0010,1100)==44字节
        数据加密方式[10-12]==0b(000)
        分包[13]==0,也即第12-15位的消息包封装项不存在
        保留位[14-15]==00
    020000000015 # 终端手机号
    0025 # 流水号
# 消息体 44个字节
002c0133373039363054372d54383038000000000000000000000000003033323931373001d4c14238383838
	002c #省域 ID
	0133 #市县域 ID
	3730393630 #制造商 ID
	54372d5438303800000000000000000000000000 #终端型号
	30333239313730 #终端 ID
	……………………
	……………………
7b # 校验码
7e # 标识位

```



[大佬的简书](https://www.jianshu.com/p/c4cd52af5338)